# Repository Guidelines

## プロジェクト構成とモジュール

アプリ は 静的 Web サイト として ルート 直下 に 置かれ ます。 新規 アセット は 機能 単位 で まとめて 保守 してください。
- `index.html` は UI の 土台 と スクリプト を 読み込み ます。 DOM 構造 は 既存 の ショートカット 設計 を 壊さない 範囲 で 更新。
- `script.js` の `FlexiSpotController` が 中核。 新機能 は クラス メソッド 化 し、 既存 イベント ハンドラ を 再利用。
- `serial-protocol.js` で コマンド フレーム を 管理。 プリセット や 診断 コマンド 追加 時 に 更新。
- `styles.css` は テーマ と レイアウト を 定義。 4 スペース インデント と ハイフン 区切り クラス 名 を 維持。
- `.github/workflows/` には Claude 自動 レビュー が あり、 プロンプト 変更 は ここ で 行う。

## ビルド・テスト・開発コマンド

Web Serial API の 制約 上、 HTTPS または localhost で 検証 します。
- 簡易 プレビュー: `python -m http.server 8000 --bind 127.0.0.1 --directory .`
- HTTPS スモーク テスト: `npx http-server-ssl -p 8443 --host 127.0.0.1 --cert cert.pem --key key.pem`
- Lint エラー が 出た 場合: `npx eslint script.js serial-protocol.js --fix` を 実行 し、 再度 チェック して から コミット。
- 新規 ツール 導入 時 は `README.md` に 手順 を 追記 し、 静的 サイト 方針 を 保つ。

## コーディングスタイルと命名

JavaScript は 4 スペース インデント、 セミコロン 必須、 メソッド 名 は camelCase。 状態 は `Set` や `Map` など 標準 API を 活用。 CSS も 4 スペース と ハイフン 区切り クラス (`.version-info` など)。 コメント は 日英 いずれも 可 だが、 シリアル プロトコル など 背景 共有 に 限定。 余分 な `console.log` は コミット 前 に 削除。

## テスト指針

現状 自動 テスト は なく、 手動 検証 が 基本。 FlexiSpot デスク や 模擬 デバイス に 接続 し、 接続／切断、 手動 上下、 プリセット、 エラー モーダル を 順番 に チェック。 ブラウザ コンソール の 警告 と 再現 条件 は PR で 共有。

## コミットとプルリク運用

履歴 は 簡潔 件名 と Issue 参照 (`Fixes #15` 形式) が 主流。 命令形 で 記述 し、 日本語 と 英語 の 混在 を 許容。 PR では 変更 概要、 UI 変更 の スクリーンショット または 動画、 手動 テスト 結果、 追加 した バイト シーケンス を 箇条書き で 記載。 準備 完了 後 に Claude レビュー を 実行。

## セキュリティと設定上の注意

ハードウェア ID、 シリアル ログ、 証明書 ファイル など 機微 情報 は コミット 禁止。 新規 バイト 配列 は ベンダー ドキュメント で 確認 し、 破壊 的 動作 には 確認 ダイアログ を 追加。 テスター へ は HTTPS 利用 と 利用 後 の ブラウザ 権限 解除 を 周知。
